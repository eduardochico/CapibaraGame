<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Capibara Runner ‚Äî Sprite + Audio</title>
  <style>
    :root{ --bg:#E8F9FF; --ground:#7ac74f; --text:#1f2937; --card:#ffffff; }
    html,body{margin:0;height:100%;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial}
    .wrap{position:relative;display:flex;align-items:center;justify-content:center;min-height:100%}
    canvas{width:min(960px,96vw);height:auto;display:block;background:linear-gradient(#b3ecff,var(--bg));border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.12)}
    .hud{position:absolute;inset:0;pointer-events:none}
    .topbar{position:absolute;top:10px;left:12px;right:12px;display:flex;align-items:center;justify-content:space-between;gap:8px}
    .score{background:rgba(255,255,255,.7);padding:6px 10px;border-radius:12px;font-weight:700;letter-spacing:.4px;pointer-events:auto}
    .btns{display:flex;gap:8px}
    button{pointer-events:auto;cursor:pointer;border:0;padding:8px 12px;border-radius:12px;background:#111827;color:#fff;font-weight:700;box-shadow:0 6px 16px rgba(0,0,0,.15)}
    button.secondary{background:#fff;color:#111827}
    .overlay{position:absolute;inset:0;display:grid;place-items:center}
    .card{background:var(--card);padding:18px 20px;border-radius:16px;box-shadow:0 14px 40px rgba(0,0,0,.2);text-align:center;max-width:min(520px,92%)}
    .card h1{margin:0 0 8px;font-size:28px}
    .card p{margin:6px 0;line-height:1.5}
    .kbd{font-weight:800;background:#111827;color:#fff;padding:2px 8px;border-radius:6px}
    .credit{position:absolute;bottom:8px;right:12px;opacity:.6;font-size:12px}
    .tests{position:absolute;bottom:8px;left:12px;background:rgba(255,255,255,.85);padding:6px 10px;border-radius:10px;font-size:12px}
    .tests b{color:#0a0}
    .tests .fail{color:#a00}
  </style>
</head>
<body>
  <div class="wrap">
    <canvas id="game" width="960" height="360" aria-label="Capibara corriendo y saltando paletas heladas"></canvas>
    <div class="hud">
      <div class="topbar">
        <div class="score" id="score">Puntuaci√≥n: 0</div>
        <div class="btns">
          <button id="btnStart">‚ñ∂Ô∏è Jugar</button>
          <button id="btnMute" class="secondary">üîá Silencio</button>
        </div>
      </div>
      <div class="overlay" id="overlay">
        <div class="card" id="card">
          <h1>Capibara Runner ü¶´üçß</h1>
          <p>Salta las <strong>paletas heladas</strong>. Toca o presiona <span class="kbd">Espacio</span>/<span class="kbd">‚Üë</span> para saltar.</p>
          <p>Con <strong>m√∫sica</strong> y <strong>sonidos</strong> generados por WebAudio.</p>
          <p style="font-size:13px;opacity:.75">Si no oyes audio, presiona <strong>Jugar</strong> (autoplay policy).</p>
        </div>
      </div>
      <div class="credit">Canvas + WebAudio</div>
      <div class="tests" id="tests">Tests: <em>corriendo‚Ä¶</em></div>
    </div>
  </div>

  <script>
  // =====================
  // üîä Audio (WebAudio)
  // =====================
  const AudioKit = (()=>{
    let ctx, master, musicG, sfxG, timer=null, step=0; const SCALE=[0,2,3,5,7,9,10];
    function ensure(){ if(!ctx){ ctx=new (window.AudioContext||window.webkitAudioContext)(); master=ctx.createGain(); master.gain.value=0.9; master.connect(ctx.destination); musicG=ctx.createGain(); musicG.gain.value=0.25; musicG.connect(master); sfxG=ctx.createGain(); sfxG.gain.value=0.9; sfxG.connect(master); } }
    function unlock(){ ensure(); if(ctx.state==='suspended') ctx.resume(); }
    function mute(on){ ensure(); master.gain.value = on? 0 : 0.9; }
    function beep({freq=880, dur=0.07, type='square'}){ ensure(); const t0=ctx.currentTime; const o=ctx.createOscillator(); const g=ctx.createGain(); o.type=type; o.frequency.value=freq; g.gain.value=0; g.gain.linearRampToValueAtTime(0.6,t0+0.01); g.gain.exponentialRampToValueAtTime(0.0001,t0+dur); o.connect(g).connect(sfxG); o.start(t0); o.stop(t0+dur+0.02); }
    function n2f(n){ return 440*Math.pow(2,(n-69)/12) }
    function play(freq,len=0.24,vol=0.15){ const t=ctx.currentTime; const o=ctx.createOscillator(); const g=ctx.createGain(); o.type='triangle'; o.frequency.value=freq; g.gain.value=0; g.gain.linearRampToValueAtTime(vol,t+0.02); g.gain.exponentialRampToValueAtTime(0.0001,t+len); o.connect(g).connect(musicG); o.start(t); o.stop(t+len+0.05); }
    function startMusic(){ ensure(); stopMusic(); step=0; const base=57; timer=setInterval(()=>{ const deg=SCALE[step%SCALE.length]; play(n2f(base+deg+12),0.22,0.18); if(step%2===0) play(n2f(base+deg-12),0.28,0.12); step=(step+1)%32; }, 240); }
    function stopMusic(){ if(timer) { clearInterval(timer); timer=null; } }
    return {unlock, mute, beep, startMusic, stopMusic};
  })();

  // =================
  // üéÆ Juego (Canvas)
  // =================
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const W = canvas.width, H = canvas.height;
  const groundY = H-64;

  let running=false, gameOver=false, t=0, speed=5, score=0, best=0;
  const gravity = 0.7, jumpVel = -12.5;

  // üñºÔ∏è Sprite del capibara ‚Äî data URI del usuario
  const CAPY_SRC = 'data:image/png;base64,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';
  const capyImg = new Image();
  capyImg.src = CAPY_SRC;
  let capyReady=false; capyImg.onload=()=>{ capyReady=true; console.log('Capy sprite cargado'); };
  capyImg.onerror=(e)=> console.warn('No se pudo cargar el capy sprite', e);

  const player = { x:120, y:0, w:60, h:60, vy:0, onGround:false };
  const pops = []; let spawnTimer=0;

  // ‚úã Entrada
  const keys = new Set(); let touchDown=false; const wantJump=()=> keys.has(' ')||keys.has('ArrowUp')||touchDown;
  canvas.addEventListener('pointerdown',()=>{ touchDown=true; if(!running) start(); });
  window.addEventListener('pointerup',()=> touchDown=false);
  window.addEventListener('keydown',e=>{ if(['Space','ArrowUp'].includes(e.code)) e.preventDefault(); keys.add(e.key); if((e.code==='Space'||e.code==='ArrowUp')&&!running) start(); if(e.key.toLowerCase()==='m') toggleMute(); });
  window.addEventListener('keyup',e=> keys.delete(e.key));

  // üß∞ UI
  const overlay = document.getElementById('overlay');
  const card = document.getElementById('card');
  const scoreEl = document.getElementById('score');
  const btnStart = document.getElementById('btnStart');
  const btnMute = document.getElementById('btnMute');
  btnStart.addEventListener('click', start);
  btnMute.addEventListener('click', toggleMute);
  let muted=false; function toggleMute(){ muted=!muted; AudioKit.mute(muted); btnMute.textContent = muted? 'üîà Con sonido' : 'üîá Silencio'; }

  function reset(){ running=false; gameOver=false; t=0; speed=5; score=0; spawnTimer=0; pops.length=0; player.y=groundY-player.h; player.vy=0; player.onGround=true; scoreEl.textContent='Puntuaci√≥n: '+score; }
  function start(){ AudioKit.unlock(); AudioKit.startMusic(); overlay.style.display='none'; if(gameOver) reset(); if(!running){ running=true; requestAnimationFrame(loop); } }
  function end(){ running=false; gameOver=true; best=Math.max(best,score); AudioKit.stopMusic(); overlay.style.display='grid'; card.innerHTML = `
      <h1>¬°Game Over! üòµ‚Äçüí´</h1>
      <p>Puntuaci√≥n: <strong>${score}</strong> ‚Ä¢ Mejor: <strong>${best}</strong></p>
      <p>Presiona <span class="kbd">Espacio</span> o toca para reintentar.</p>
      <div style="margin-top:10px"><button onclick="(${start.toString()})()">Reintentar</button></div>`; }

  // Obst√°culos (paletas peque√±as)
  function spawnPop(){ const w=28+Math.random()*10, h=50+Math.random()*15; pops.push({ x:W+20, y:groundY-h, w, h }); }
  function collide(a,b){ return !(a.x+a.w < b.x+6 || a.x+6 > b.x+b.w || a.y+a.h < b.y+6 || a.y+6 > b.y+b.h); }

  function drawPop(x,y,w,h){
    ctx.fillStyle = '#c79c55'; roundRect(x+w*0.4, y+h*0.9, w*0.2, h*0.5, 6); ctx.fill();
    const colors = ['#ff6b6b','#ffd93d','#6bcb77','#4d96ff','#a78bfa'];
    ctx.fillStyle = colors[Math.floor((x/37)%colors.length)]; roundRect(x, y, w, h, 12); ctx.fill();
    ctx.fillStyle = 'rgba(255,255,255,.5)'; roundRect(x+w*0.1, y+h*0.1, w*0.12, h*0.5, 6); ctx.fill();
  }
  function roundRect(x,y,w,h,r){ ctx.beginPath(); ctx.moveTo(x+r,y); ctx.arcTo(x+w,y,x+w,y+h,r); ctx.arcTo(x+w,y+h,x,y+h,r); ctx.arcTo(x,y+h,x,y,r); ctx.arcTo(x,y,x+w,y,r); ctx.closePath(); }

  function drawCapy(x,y,w,h){
    // üëâ Sin sombra, y sprite volteado horizontalmente
    if(capyReady || (capyImg.complete && capyImg.naturalWidth>0)){
      ctx.save(); ctx.scale(-1,1); ctx.drawImage(capyImg, -x - w, y, w, h); ctx.restore();
    } else { ctx.fillStyle='#b88b5c'; ctx.fillRect(x,y,w,h); }
  }

  function drawGround(){ ctx.fillStyle=getComputedStyle(document.documentElement).getPropertyValue('--ground'); ctx.fillRect(0, groundY, W, H-groundY); ctx.strokeStyle='rgba(0,0,0,.06)'; ctx.lineWidth=1; for(let x=0;x<W;x+=20){ ctx.beginPath(); ctx.moveTo((x-(t*speed)%20),groundY); ctx.lineTo((x-(t*speed)%20)+10, groundY-4); ctx.stroke(); } }
  function drawBackground(){ ctx.save(); ctx.globalAlpha=0.7; const n=5; for(let i=0;i<n;i++){ const nx=(i*220 - (t*speed*0.3)%(W+240)) - 80; const ny=40 + (i%3)*25; cloud(nx,ny,80+(i%2)*30, 30+(i%2)*10); } ctx.restore(); }
  function cloud(x,y,w,h){ ctx.fillStyle='rgba(255,255,255,.9)'; ctx.beginPath(); ctx.ellipse(x,y,w*0.6,h,0,0,Math.PI*2); ctx.ellipse(x+w*0.3,y-8,w*0.4,h*1.1,0,0,Math.PI*2); ctx.ellipse(x-w*0.2,y-6,w*0.35,h*0.9,0,0,Math.PI*2); ctx.fill(); }

  function update(){
    if(!running) return;
    t += 1/60; score += 1; if(score%60===0) speed = Math.min(16, speed + 0.4);
    if(Math.random() < Math.min(0.02 + speed*0.0015, 0.06) && spawnTimer<=0){ spawnPop(); spawnTimer = 40 + Math.random()*40; } else { spawnTimer--; }

    player.vy += gravity; player.y += player.vy; player.onGround=false;
    if(player.y + player.h >= groundY){ player.y = groundY - player.h; player.vy = 0; player.onGround = true; }
    if(wantJump() && player.onGround){ player.vy = jumpVel; player.onGround=false; if(!muted) AudioKit.beep({freq:880,dur:0.07,type:'square'}); }

    for(let i=pops.length-1;i>=0;i--){ const o=pops[i]; o.x -= speed; if(o.x + o.w < -20) pops.splice(i,1); if(collide({x:player.x,y:player.y,w:player.w,h:player.h}, o)){ if(!muted) AudioKit.beep({freq:120,dur:0.2,type:'sawtooth'}); end(); } }

    scoreEl.textContent = 'Puntuaci√≥n: '+score;
  }

  function render(){ ctx.clearRect(0,0,W,H); drawBackground(); drawGround(); drawCapy(player.x,player.y,player.w,player.h); for(const o of pops) drawPop(o.x,o.y,o.w,o.h); }
  function loop(){ update(); render(); if(running) requestAnimationFrame(loop); }

  document.addEventListener('visibilitychange', ()=>{ if(document.hidden && running){ running=false; AudioKit.stopMusic(); } });

  reset();

  // ==============================
  // ‚úÖ Pruebas r√°pidas
  // ==============================
  (function runTests(){
    const out = document.getElementById('tests');
    const results = [];
    function pass(name){ results.push(`‚úîÔ∏è ${name}`); }
    function fail(name,msg){ results.push(`‚ùå ${name} ‚Äî ${msg||''}`); }

    try { const a={x:0,y:0,w:10,h:10}, b={x:5,y:5,w:10,h:10}, c={x:20,y:20,w:5,h:5}; if(collide(a,b) && !collide(a,c)) pass('AABB collide'); else fail('AABB collide','resultado inesperado'); } catch(e){ fail('AABB collide', e.message); }
    try { const tmpH=40, gY=100; let vy=5, y= gY - tmpH - 1; vy += gravity; y += vy; if(y + tmpH >= gY){ y = gY - tmpH; vy=0; } if(y === gY - tmpH && vy === 0) pass('F√≠sica suelo'); else fail('F√≠sica suelo'); } catch(e){ fail('F√≠sica suelo', e.message); }
    try { setTimeout(()=>{ if(capyReady || (capyImg.complete && capyImg.naturalWidth>0)) pass('Sprite capy cargado'); else fail('Sprite capy cargado','no est√° listo'); out.innerHTML = 'Tests: ' + results.map(x=>`<b>${x}</b>`).join(' ¬∑ ').replaceAll('‚ùå','<span class="fail">‚ùå</span>'); }, 150); } catch(e){ fail('Sprite capy cargado', e.message); }
  })();
  </script>
</body>
</html>
